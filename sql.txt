CREATE TABLE USER_MST (UID SERIAL PRIMARY KEY, USERNAME TEXT, PASSWORD TEXT , STATUS CHAR(1));

CREATE TABLE ROLE_MST (ROLEID SERIAL PRIMARY KEY, NAME TEXT, DESCR TEXT , STATUS CHAR(1));

CREATE TABLE RIGHT_MST (RIGHTID SERIAL PRIMARY KEY, NAME TEXT, DESCR TEXT , STATUS CHAR(1),SCREEN TEXT);

CREATE TABLE USER_ROLE_MAPPING (MAPID SERIAL PRIMARY KEY, USERID INT REFERENCES USER_MST(UID) ON DELETE CASCADE,ROLEID INT REFERENCES ROLE_MST(ROLEID) ON DELETE CASCADE ,STATUS CHAR(1) DEFAULT 'Y' );

CREATE TABLE ROLE_RIGHT_MAPPING (MAPID SERIAL PRIMARY KEY, ROLEID INT REFERENCES ROLE_MST(ROLEID) ON DELETE CASCADE,RIGHTID INT REFERENCES RIGHT_MST(RIGHTID) ON DELETE CASCADE ,STATUS CHAR(1) DEFAULT 'Y' );


INSERT INTO USER_MST (USERNAME,PASSWORD,STATUS) VALUES('amit','amit1234','Y');
INSERT 0 1
onlineshop=# INSERT INTO USER_MST (USERNAME,PASSWORD,STATUS) VALUES('ram','ram1234','Y'); 
INSERT 0 1
onlineshop=# SELECT * FROM USER_MST;
 uid | username | password | status 
-----+----------+----------+--------
   1 | amit     | amit1234 | Y
   2 | ram      | ram1234  | Y
(2 rows)

onlineshop=# INSERT INTO ROLE_MST (NAME,DESCR,STATUS) VALUES('ADMIN','THIS IS ADMIN','Y'); 
INSERT 0 1
onlineshop=# INSERT INTO ROLE_MST (NAME,DESCR,STATUS) VALUES('CUSTOMER','THIS IS CUSTOMER','Y');
INSERT 0 1
onlineshop=# SELECT * FROM ROLE_MST;
 roleid |   name   |      descr       | status 
--------+----------+------------------+--------
      1 | ADMIN    | THIS IS ADMIN    | Y
      2 | CUSTOMER | THIS IS CUSTOMER | Y
(2 rows)

onlineshop=# INSERT INTO USER_ROLE_MAPPING (USERID,ROLEID) VALUES(1,1);
INSERT 0 1
onlineshop=# INSERT INTO USER_ROLE_MAPPING (USERID,ROLEID) VALUES(1,2);
INSERT 0 1
onlineshop=# INSERT INTO USER_ROLE_MAPPING (USERID,ROLEID) VALUES(2,2);
INSERT 0 1
onlineshop=# SELECT * FROM USER_ROLE_MAPPING;
 mapid | userid | roleid | status 
-------+--------+--------+--------
     1 |      1 |      1 | Y
     2 |      1 |      2 | Y
     3 |      2 |      2 | Y
(3 rows)

onlineshop=# INSERT INTO RIGHT_MST (NAME,DESCR,STATUS,SCREEN) VALUES('ADD NEW PRODUCT','ADD SCREEN FOR PRODUCT','Y','addproduct.jsp');
INSERT 0 1
onlineshop=# INSERT INTO RIGHT_MST (NAME,DESCR,STATUS,SCREEN) VALUES('DELETE PRODUCT','DELETE SCREEN FOR PRODUCT','Y','deleteproduct.jsp');
INSERT 0 1
onlineshop=# SELECT * FROM RIGHT_MST;
 rightid |      name       |           descr           | status |      screen       
---------+-----------------+---------------------------+--------+-------------------
       1 | ADD NEW PRODUCT | ADD SCREEN FOR PRODUCT    | Y      | addproduct.jsp
       2 | DELETE PRODUCT  | DELETE SCREEN FOR PRODUCT | Y      | deleteproduct.jsp
(2 rows)

onlineshop=# INSERT INTO ROLE_RIGHT_MAPPING (ROLEID,RIGHTID) VALUES(1,1);
INSERT 0 1
onlineshop=# INSERT INTO ROLE_RIGHT_MAPPING (ROLEID,RIGHTID) VALUES(1,2);
INSERT 0 1
onlineshop=# INSERT INTO ROLE_RIGHT_MAPPING (ROLEID,RIGHTID) VALUES(2,1);
INSERT 0 1



SELECT USER_MST.USERNAME AS USERID, ROLE_MST.NAME AS ROLE,RIGHT_MST.NAME AS RIGHT FROM USER_MST, ROLE_MST,RIGHT_MST ,USER_ROLE_MAPPING,ROLE_RIGHT_MAPPING WHERE USER_MST.UID=USER_ROLE_MAPPING.USERID AND ROLE_MST.ROLEID=USER_ROLE_MAPPING.ROLEID AND ROLE_MST.ROLEID=ROLE_RIGHT_MAPPING.ROLEID AND RIGHT_MST.RIGHTID=ROLE_RIGHT_MAPPING.RIGHTID AND USER_MST.USERNAME='amit' AND USER_MST.PASSWORD='amit1234';
